{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Getting started","text":"<p>Here you will find some examples for common M3G tasks using the M3G application programming interface (API).</p> <p>You can start by:</p> <ul> <li>using a command-line tool such as curl to download/upload data from/to  M3G</li> <li>use python (interactively, in a script, etc.).</li> </ul> <p>If you are familiar with RESTful API, go directly to the M3G Swagger UI (see below) to visualize and interact with the API.</p> <p></p>"},{"location":"authorization/","title":"M3G access token","text":"<p>For some operations, you need to be authorized i.e. you need the \"Application access token\": you can find it in \"My Agency\" once logged in in M3G, see the figure below:</p> <p></p>"},{"location":"curl_download/","title":"Download data from M3G","text":"<p>In the Bash shell, one could use a command-line such <code>curl</code> to access M3G API: it acts as an HTTP client and allows you to send requests and display/store the corresponding responses.</p>"},{"location":"curl_download/#get-the-sitelog-of-a-given-station","title":"<code>GET</code> the sitelog of a given station","text":"<p>Let's say you have identified a site log (i.e. information that you also get in the M3G website) by the station 9-characters id aka <code>id</code> e.g. BRUX00BEL, and you want to download it. M3G allows you to do this and get the output in various formats: JSON, GeodesyML or IGS site log format. To get the JSON is the format:</p> <pre><code>curl -s -X GET \"https://gnss-metadata.eu/__test/v1/sitelog/view?id=BRUX00BEL\" -H  \"accept: application/json\"\n</code></pre> <p>Here we used <code>curl</code> to send an HTTP GET request to return the resource located by the given URL. In practice you can omit the <code>-X GET</code> (which is the default) and you might want to 'nicely' format the output with <code>json_pp</code>:</p> <pre><code>curl -s -X GET \"https://gnss-metadata.eu/__test/v1/sitelog/view?id=BRUX00BEL\" -H  \"accept: application/json\" | json_pp\n</code></pre> <p>and get the following output:</p> <pre><code>{\n\"_links\" : {\n\"geodesyML\" : {\n\"href\" : \"https://gnss-metadata.eu/__test/v1/sitelog/exportxml?id=BRUX00BEL\"\n},\n\"self\" : {\n\"href\" : \"https://gnss-metadata.eu/__test/v1/sitelog/view?id=BRUX00BEL\"\n},\n\"sitelog\" : {\n\"href\" : \"https://gnss-metadata.eu/__test/v1/sitelog/exportlog?id=BRUX00BEL\"\n}\n},\n\"dateUpdate\" : \"2020-09-30T09:39Z\",\n\"geodesymlName\" : \"BRUX00BEL.xml\",\n\"id\" : \"BRUX00BEL\",\n...\n</code></pre> <p>For the GeodesyML or the IGS site log format:</p> <pre><code>curl -s -X GET \"https://gnss-metadata.eu/__test/v1/sitelog/exportxml?id=BRUX00BEL\" -H  \"accept: application/geodesyML0.4\"\n</code></pre> <pre><code>curl -s -X GET \"https://gnss-metadata.eu/__test/v1/sitelog/exportlog?id=BRUX00BEL\" -H  \"accept: application/sitelog\"\n</code></pre>"},{"location":"curl_download/#get-the-sitelogs-of-all-stations-matching-a-search-criterion","title":"<code>GET</code> the sitelogs of all stations matching a search criterion","text":"<p>Let's say you want to get the site log for entries that fit a give search criterion, e.g. stations having the string \"PRAG\" in their 9-char id:</p> <pre><code>curl -g -s -X GET \"https://gnss-metadata.eu/__test/v1/sitelog?page=1&amp;filter[id][like]=PRAG\" -H  \"accept: text/plain\"\n</code></pre> <p>As you can notice by looking at the command line above, you can select which page of results should be returned (<code>?page=1</code>). This is one of the \"pagination\" parameters. See, for example, a REST API handbook for more info. More conveniently, one can select one of the columns of the output and get:</p> <pre><code>curl -g -s -X GET \"https://gnss-metadata.eu/__test/v1/sitelog?page=1&amp;filter[id][like]=PRAG\" -H  \"accept: text/plain\" | awk '{print $1}'\n</code></pre> <p>and get:</p> <pre><code>id\nPRAG00CZE\nPRAG00REU\n...\n</code></pre> <p>aka the site logs of the entries match your search criterion: <code>filter[id][like]=PRAG</code>. There are various other query parameters. You might find some others in the generated swagger dashboard of our API. Note that, on most terminals, if <code>[]</code>and/or <code>{}</code> are present in the URL, one needs to add <code>-g</code> to the command line to disable the \"URL globbing parser\" and escape parentheses.</p>"},{"location":"curl_download/#get-the-list-of-stations-included-in-a-given-network","title":"<code>GET</code> the list of stations included in a given network","text":"<p>It could be useful to simply get a list of stations (9-char id) included in a given network e.g. EPN, EPOS. Here we'll need to use <code>curl</code> and a bit of Python, but no special libraries:</p> <pre><code>curl -s -X GET \"https://gnss-metadata.eu/__test/v1/network/view?id=EPN\" -H  \"accept: application/json\" | python -c \"import sys,json; print(json.load(sys.stdin)['included'])\"\n</code></pre> <p>You'll get a list of stations e.g.</p> <pre><code>['BRUX00BEL', 'AUBG00DEU', 'NOA100GRC', 'GOR200DEU', 'BORJ00DEU', 'HEL200DEU',...\n</code></pre> <p>Similarly, to get the list of stations proposed to a given network e.g. EPOS:</p> <pre><code>curl -s -X GET \"https://gnss-metadata.eu/__test/v1/network/view?id=EPOS\" -H  \"accept: application/json\" | python -c \"import sys,json; print(json.load(sys.stdin)['proposed'])\"\n</code></pre>"},{"location":"curl_download/#get-list-of-satellite-systems-that-a-given-station-is-currently-tracking","title":"<code>GET</code> list of satellite systems that a given station is currently tracking","text":"<pre><code>curl -s -X GET \"https://gnss-metadata.eu/__test/v1/sitelog/view?id=BRUX00BEL\" -H  \"accept: application/json\" | python -c \"import sys,json; print(json.load(sys.stdin)['sitelog']['receivers'][-1]['satelliteSystem'])\"\n</code></pre> <pre><code>['GPS', 'GLO', 'GAL', 'BDS', 'QZSS', 'IRNSS', 'SBAS']\n</code></pre>"},{"location":"curl_upload/","title":"Upload data to M3G","text":"<p>In the Bash shell, one could use a command-line such <code>curl</code> to access M3G API: it acts as an HTTP client and allows you to send requests and display/store the corresponding responses.</p>"},{"location":"curl_upload/#put-to-update-the-firmware-section-in-the-sitelog-of-a-given-station","title":"<code>PUT</code> to update the firmware section in the sitelog of a given station","text":"<p>Let's look at a quick test example on how to update/change the firmware section of station (given its 9-character id). Indeed, if one has a look at the M3G API documentation, the required argument are the <code>id</code> aka the station 9-characters id and the records that will be changed as key/values pairs: the name of the person who is allowed to change the site log (<code>updateMadeBy</code>), the new firmware version (<code>changedTo</code>) and the date.</p> <p>To do this, one needs choose a station belonging to his/her agency and first get authorized. You need the \"Application access token\". Let's pick the station BRUX00BEL and let's say I'd like to change the version of its firmware to '5.3.1'.</p> <p>One would need to pass some data, in json format e.g. stored in the file <code>firmware.json</code>:</p> <pre><code>{\n\"updateMadeBy\": \"Carine Bruyninx\",\n\"endOfTheLastSection\": \"2020-09-30T09:35Z\",\n\"changedTo\": \"5.3.1\",\n\"startOfTheNewSection\": \"2020-09-30T09:36Z\"\n}\n</code></pre> <p>where the name of the person appearing as <code>updateMadeBy</code> must correspond to one of the contacts already set up in the My agency page in M3G (see figure above).</p> <p>Then, via <code>curl</code>:</p> <pre><code>curl -i -X PUT \"https://gnss-metadata.eu/__test/v1/sitelog/firmware-change?id=BRUX00BEL\" -H  \"accept: application/json\" -H  \"Authorization: Bearer xxx..\" -H  \"Content-Type: application/json\" -d @firmware.json\n</code></pre> <p>where <code>xxx..</code> is your \"Application access token\". The option <code>-i</code> will allow you to get back some useful information about your HTTP request, including HTTP response status code (defined by HTTP standards) e.g. <code>200</code> for a successful request:</p> <pre><code>HTTP/1.1 200 OK\nDate: Wed, 30 Sep 2020 09:39:55 GMT\nServer: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips\nVary: Accept\nSet-Cookie: _csrf=8fcbeb32215f670ee60463f6276a160c385a199d5e096863abc43c8bb5e8d782a%3A2%3A%7Bi%3A0%3Bs%3A5%3A%22_csrf%22%3Bi%3A1%3Bs%3A32%3A%22RsJfDHRXLUxqkdYTqnxwE9oRysUseDiE%22%3B%7D; path=/; HttpOnly\nContent-Length: 590\nContent-Type: application/json; charset=UTF-8\n\n{\"id\":\"BRUX00BEL\",\n\"uri\":\"https://gnss-metadata.eu/__test/v1/sitelog/view?id=BRUX00BEL\",\n\"md5Sitelog\":\"c569da06b17e8acf75e30c86c6024935\",\n\"md5Geodesyml\":\"8613e46ce60c32b260b72915ffef770c\",\n\"sitelogName\":\"brux00bel_20200930.log\",\n\"geodesymlName\":\"BRUX00BEL.xml\",\n\"preparedDate\":\"2020-09-30T00:00Z\",\n\"dateUpdate\":\"2020-09-30T09:39Z\",\n\"_links\":{\"self\":{\"href\":\"https://gnss-metadata.eu/__test/v1/sitelog/view?id=BRUX00BEL\"},\"geodesyML\":{\"href\":\"https://gnss-metadata.eu/__test/v1/sitelog/exportxml?id=BRUX00BEL\"},\"sitelog\":{\"href\":\"https://gnss-metadata.eu/__test/v1/sitelog/exportlog?id=BRUX00BEL\"}}}\n</code></pre> <p>In the output information above, you also get the links to download the updated site log in various format e.g. https://gnss-metadata.eu/__test/v1/sitelog/exportlog?id=BRUX00BEL</p>"},{"location":"disclaimer/","title":"Disclaimer","text":"<p>The examples presented here were only tested on GitBash and MobaXTerm (Windows), Bash (for Linux etc) and Terminal (MacOS).</p>"},{"location":"intro/","title":"Short intro to M3G API","text":"<p>M3G offers some of its functionalities through an application programming interface (API). In particular, a RESTful HTTP API that allows you to interact with M3G purely as data that can be uploaded, accessed, searched for, etc. via HTTP requests.</p> <p>HTTP basically allows you to <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code> etc. resources on a remote server. These resources are identified via URLs (=uniform resource locator). URLs usually consists of a protocol (e.g. HTTP), a domain (our servers), a path (a place on our servers), and query parameters (additional options).</p>"},{"location":"intro/#m3g-api-available-operations","title":"M3G API: available operations","text":"<p>At present, M3G API provides 5 main \"groups\" of operations:</p> <ul> <li>Network</li> <li>License</li> <li>Metadata, Product and Update (i.e. to get info, export or update some sections of station site logs in M3G, respectively)</li> </ul> <p>Within most of these resource \"groups\", you find endpoints that either allow you to retrieve info on a given M3G entry (i.e. a network, a station) or to ask a query to locate many M3G entries at the same time (see the M3G Swagger user interface).</p>"},{"location":"intro/#m3g-api-tools","title":"M3G API: tools","text":"<p>One can start to test M3G API thanks to different tools and libraries. For example, one could use:</p> <ul> <li>an HTTP program like curl to directly use M3G API from within a shell</li> <li>a generic Python HTTP library such as requests</li> <li>the browser, via the M3G Swagger UI, based on an OpenAPI spec, describing some of M3G function calls</li> </ul> <p>In the following sections, you'll find some examples for common M3G tasks using various tools/options.</p>"},{"location":"python/","title":"Use python requests library","text":"<p>One could integrate the REST API with different languages, for example Python. Similar to <code>curl</code> in the shell, you can use requests in Python (quickly installable via <code>pip install requests</code>). It's a generic HTTP client library that allows you to send HTTP requests.</p> <p>Let's look at the test example mentioned above, on how to update/change the firmware section of a station. To do this, one needs to get authorization via the \"Application access token\":</p> <pre><code>import requests\n\nheaders={'accept': 'application/json', 'Authorization': 'Bearer xxx..'}\n# where 'xxx..' is your \"Application access token\"\n\n# authorization is not needed for GET requests:\n#headers={'accept': 'application/json'}\n</code></pre>"},{"location":"python/#examples-of-some-basic-functions-to-interact-m3g-api-via-requests","title":"Examples of some basic functions to interact M3G API via requests","text":"<p>As mentioned in the example with <code>curl</code>, to perform this specific task, the M3G API requires the <code>id</code> aka the station 9-characters id and the records that will be changed as key/values pairs: the name of the person who is allowed to change the site log (<code>updateMadeBy</code>), the new firmware version (<code>changedTo</code>) and the date. One could write a couple of functions on the fly using the requests module we have just loaded:</p> <pre><code>#store the M3G API URL:\ndef url(path):\n    return 'https://gnss-metadata.eu/v1/' + path\n#get info about a site log giventhe 9-char id:\ndef get_sitelog(station_id):\n    return requests.get(url('sitelog/view?id={}'.format(station_id)),headers=headers)\n#update a record in the site log (the firmware version in this case) given the 9-char id:\ndef update_firmware(station_id, updateMadeBy, changedTo, datetimeISO, datetimeISOfuture):\n    url = url('sitelog/firmware-change?id={}'.format(station_id))\n    return requests.put(url, json={\n        'updateMadeBy': updateMadeBy,\n        'changedTo': changedTo,\n        'endOfTheLastSection': datetimeISO,\n        'startOfTheNewSection': datetimeISOfuture,\n        }, headers=headers)\n</code></pre>"},{"location":"python/#update-the-sitelog-with-a-new-firmware","title":"Update the sitelog with a new firmware","text":"<p>We then send the request to update the site log with the mandatory information:</p> <pre><code>my_update=update_firmware('BRUX00BEL','Carine Bruyninx', '5.3.1', '2020-09-04T11:50Z', '2020-09-04T11:51Z')\nmy_update.status_code\n</code></pre> <p>The latter will return as a response one of HTTP status codes, as we mentioned before:</p> <pre><code>200\n</code></pre>"},{"location":"python/#retrieve-the-sitelog","title":"Retrieve the sitelog","text":"<p>We can now check if the record now stored in  M3G is what we expect. We might want to get the link to the updated site log:</p> <pre><code>my_update.url\n</code></pre> <pre><code>'https://gnss-metadata.eu/__test/v1/sitelog/view?id=BRUX00BEL'\n</code></pre> <p>or retrieve the info about the sitelog of our station (BRUX00BEL)</p> <pre><code>my_station=get_sitelog('BRUX00BEL')\nmy_station.status_code\n</code></pre> <p>and indeed the request is successful:</p> <pre><code>200\n</code></pre>"},{"location":"python/#get-information-about-the-firmware-version-stored-in-the-sitelog","title":"Get information about the firmware version stored in the sitelog","text":"<p>We can now have a look at the content of the record we're interested in aka <code>firmwareVersion</code>:</p> <pre><code>my_station.json()['sitelog']['receivers'][-1]['firmwareVersion']\n</code></pre> <p>and get:</p> <pre><code>'5.3.1'\n</code></pre>"},{"location":"python/#download-the-sitelog-of-a-given-station-at-a-specific-day","title":"Download the sitelog of a given station at a specific day","text":"<p>As an alternative, we can use another available <code>GET</code> request <code>/sitelog/day-view</code>. This allows you to download metadata corresponding to a specific day (in the YYYY-MM-DD format) for a given station. For example:</p> <pre><code> #get info about a site log at a given date YYYY-MM-DD) and given the 9-char id:\n def get_sitelog_date(station_id, date):\n     return requests.get(url('sitelog/day-view?id={}&amp;date={}'.format(station_id,date)),headers=headers)\n\nmy_station=get_sitelog_date('BRUX00BEL','2019-06-06')\nmy_station.json()['sitelog']['receivers'][-1]['firmwareVersion']\n</code></pre> <p>and get:</p> <pre><code>'2.9.6-extref3'\n</code></pre> <p>.</p>"}]}